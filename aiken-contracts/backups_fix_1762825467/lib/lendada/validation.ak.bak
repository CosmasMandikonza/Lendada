use aiken/hash.{Blake2b_224, Hash}
use aiken/list
use aiken/transaction.{Input, Output, Transaction}
use aiken/transaction/credential.{VerificationKey}
use aiken/transaction/value.{AssetName, PolicyId, quantity_of}

/// Verify that an input set contains exactly one given asset (policy_id, asset_name)
pub fn verify_identity_nft(
  inputs: List<Input>,
  policy_id: PolicyId,
  asset_name: AssetName,
) -> Bool {
  list.any(
    inputs,
    fn(input) { quantity_of(input.output.value, policy_id, asset_name) == 1 },
  )
}

/// Constant-time style comparison placeholder (byte arrays)
pub fn verify_zk_proof(
  stored_hash: ByteArray,
  provided_hash: ByteArray,
) -> Bool {
  stored_hash == provided_hash
}

/// Verify a required signer is in extra_signatories
pub fn verify_signature(
  signatories: List<Hash<Blake2b_224, VerificationKey>>,
  required_signer: Hash<Blake2b_224, VerificationKey>,
) -> Bool {
  list.has(signatories, required_signer)
}
